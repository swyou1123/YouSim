{"version":3,"file":"index.client.js","sources":["../../src/index.client.ts"],"sourcesContent":["import { configureScope, init as reactInit, Integrations } from '@sentry/react';\nimport { BrowserTracing, defaultRequestInstrumentationOptions } from '@sentry/tracing';\nimport { EventProcessor } from '@sentry/types';\n\nimport { nextRouterInstrumentation } from './performance/client';\nimport { buildMetadata } from './utils/metadata';\nimport { NextjsOptions } from './utils/nextjsOptions';\nimport { addIntegration, UserIntegrations } from './utils/userIntegrations';\n\nexport * from '@sentry/react';\nexport { nextRouterInstrumentation } from './performance/client';\nexport { captureUnderscoreErrorException } from './utils/_error';\n\nexport { Integrations };\n\n// Previously we expected users to import `BrowserTracing` like this:\n//\n// import { Integrations } from '@sentry/nextjs';\n// const instance = new Integrations.BrowserTracing();\n//\n// This makes the integrations unable to be treeshaken though. To address this, we now have\n// this individual export. We now expect users to consume BrowserTracing like so:\n//\n// import { BrowserTracing } from '@sentry/nextjs';\n// const instance = new BrowserTracing();\nexport { BrowserTracing };\n\n// Treeshakable guard to remove all code related to tracing\ndeclare const __SENTRY_TRACING__: boolean;\n\n/** Inits the Sentry NextJS SDK on the browser with the React SDK. */\nexport function init(options: NextjsOptions): void {\n  buildMetadata(options, ['nextjs', 'react']);\n  options.environment = options.environment || process.env.NODE_ENV;\n\n  let integrations = options.integrations;\n\n  // Guard below evaluates to true unless __SENTRY_TRACING__ is text-replaced with \"false\"\n  if (typeof __SENTRY_TRACING__ === 'undefined' || __SENTRY_TRACING__) {\n    // Only add BrowserTracing if a tracesSampleRate or tracesSampler is set\n    if (options.tracesSampleRate !== undefined || options.tracesSampler !== undefined) {\n      integrations = createClientIntegrations(options.integrations);\n    }\n  }\n\n  reactInit({\n    ...options,\n    integrations,\n  });\n\n  configureScope(scope => {\n    scope.setTag('runtime', 'browser');\n    const filterTransactions: EventProcessor = event =>\n      event.type === 'transaction' && event.transaction === '/404' ? null : event;\n    filterTransactions.id = 'NextClient404Filter';\n    scope.addEventProcessor(filterTransactions);\n  });\n}\n\nfunction createClientIntegrations(integrations?: UserIntegrations): UserIntegrations {\n  const defaultBrowserTracingIntegration = new BrowserTracing({\n    tracingOrigins: [...defaultRequestInstrumentationOptions.tracingOrigins, /^(api\\/)/],\n    routingInstrumentation: nextRouterInstrumentation,\n  });\n\n  if (integrations) {\n    return addIntegration(defaultBrowserTracingIntegration, integrations, {\n      BrowserTracing: { keyPath: 'options.routingInstrumentation', value: nextRouterInstrumentation },\n    });\n  } else {\n    return [defaultBrowserTracingIntegration];\n  }\n}\n"],"names":[],"mappings":";;;;;;;;;;;AA2BA;;AAGA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;"}