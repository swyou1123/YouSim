Object.defineProperty(exports, '__esModule', { value: true });

var react = require('@sentry/react');
var tracing = require('@sentry/tracing');
var client = require('./performance/client.js');
var metadata = require('./utils/metadata.js');
var userIntegrations = require('./utils/userIntegrations.js');
var _error = require('./utils/_error.js');

// Treeshakable guard to remove all code related to tracing

/** Inits the Sentry NextJS SDK on the browser with the React SDK. */
function init(options) {
  metadata.buildMetadata(options, ['nextjs', 'react']);
  options.environment = options.environment || process.env.NODE_ENV;

  let integrations = options.integrations;

  // Guard below evaluates to true unless __SENTRY_TRACING__ is text-replaced with "false"
  if (typeof __SENTRY_TRACING__ === 'undefined' || __SENTRY_TRACING__) {
    // Only add BrowserTracing if a tracesSampleRate or tracesSampler is set
    if (options.tracesSampleRate !== undefined || options.tracesSampler !== undefined) {
      integrations = createClientIntegrations(options.integrations);
    }
  }

  react.init({
    ...options,
    integrations,
  });

  react.configureScope(scope => {
    scope.setTag('runtime', 'browser');
    var filterTransactions = event =>
      event.type === 'transaction' && event.transaction === '/404' ? null : event;
    filterTransactions.id = 'NextClient404Filter';
    scope.addEventProcessor(filterTransactions);
  });
}

function createClientIntegrations(integrations) {
  var defaultBrowserTracingIntegration = new tracing.BrowserTracing({
    tracingOrigins: [...tracing.defaultRequestInstrumentationOptions.tracingOrigins, /^(api\/)/],
    routingInstrumentation: client.nextRouterInstrumentation,
  });

  if (integrations) {
    return userIntegrations.addIntegration(defaultBrowserTracingIntegration, integrations, {
      BrowserTracing: { keyPath: 'options.routingInstrumentation', value: client.nextRouterInstrumentation },
    });
  } else {
    return [defaultBrowserTracingIntegration];
  }
}

exports.Integrations = react.Integrations;
exports.BrowserTracing = tracing.BrowserTracing;
exports.nextRouterInstrumentation = client.nextRouterInstrumentation;
exports.captureUnderscoreErrorException = _error.captureUnderscoreErrorException;
exports.init = init;
for (var k in react) {
  if (k !== 'default' && !exports.hasOwnProperty(k)) exports[k] = react[k];
}
//# sourceMappingURL=index.client.js.map
